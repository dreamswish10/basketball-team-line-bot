# 🏀 群組分隊功能說明

## 📋 功能概述

籃球分隊機器人現已支援 LINE 群組功能！可以直接使用群組成員進行分隊，無需每位成員手動註冊。

## ⚙️ 設定要求

### LINE Developers Console 設定

在使用群組功能前，請確認以下設定已啟用：

1. **登入 LINE Developers Console**
   - 網址：https://developers.line.biz/console/
   - 選擇您的 Provider 和 Channel

2. **啟用必要權限**
   - 前往 "Messaging API" 標籤
   - 確認以下設定：
     ```
     ✅ 群組和多人聊天室功能 - 啟用
     ✅ 取得群組聊天室成員的用戶 ID - 啟用
     ✅ 取得群組聊天室成員的個人資料 - 啟用
     ✅ Use webhook - 啟用
     ```

3. **事件設定**
   - 確認接收以下事件：
     - Message events
     - Join Event (當 Bot 加入群組)
     - Member Join Event (群組新增成員)
     - Member Leave Event (群組成員離開)

## 🚀 使用方式

### 1. 將機器人加入群組
- 在群組中輸入機器人的 LINE ID 或掃描 QR Code
- 機器人會自動發送歡迎訊息並同步群組成員

### 2. 群組專用指令

#### 🏀 `/group_team [隊數]` - 群組快速分隊
```
/group_team        # 預設分成 2 隊
/group_team 3      # 分成 3 隊
/group_team 4      # 分成 4 隊
```
- 自動獲取群組所有成員
- 為成員分配預設技能值 (投籃5, 防守5, 體力5)
- 智能平衡分隊
- 顯示視覺化分隊結果

#### 👥 `/group_players` - 查看群組成員
```
/group_players
```
- 顯示所有群組成員清單
- 區分已註冊球員和一般成員
- 顯示技能值和評分
- 提供快速分隊按鈕

#### 📊 `/group_stats` - 群組統計資訊
```
/group_stats
```
- 群組總成員數
- 已註冊 vs 一般成員數量
- 平均技能統計
- 分隊建議

#### 🔄 `/sync` - 手動同步成員
```
/sync
```
- 手動同步群組最新成員清單
- 當有新成員加入但未自動更新時使用

### 3. 混合使用模式

群組功能與個人註冊功能完全相容：

#### 個人詳細註冊
```
/register 小明 8 7 9    # 在群組中註冊詳細技能
```
- 群組成員可以在群組內註冊詳細的技能資料
- 註冊後的成員在分隊時會使用真實技能值
- 未註冊的成員會使用預設技能值

#### 分隊優先順序
1. **已註冊球員** - 使用真實技能值
2. **群組成員** - 使用預設技能值 (5,5,5)

## 🎯 使用場景

### 1. 公司籃球社團
- 將機器人加入公司籃球群組
- 快速分隊進行友誼賽
- 支援動態成員更新

### 2. 學校班級活動
- 體育課程分組
- 班際比賽分隊
- 無需複雜註冊流程

### 3. 朋友聚會
- 臨時籃球聚會
- 快速公平分隊
- 即時開始比賽

### 4. 定期球隊
- 固定成員詳細註冊
- 新加入成員快速參與
- 長期技能追蹤

## 📱 操作流程示例

### 快速分隊流程
```
1. 管理員：將機器人加入群組
2. 機器人：自動同步成員並發送歡迎訊息
3. 任何成員：輸入 /group_team
4. 機器人：顯示分隊結果和隊伍統計
```

### 混合模式流程
```
1. 部分成員：/register 姓名 技能值 (詳細註冊)
2. 任何成員：/group_team (包含註冊+未註冊成員分隊)
3. 機器人：優先使用註冊技能，其餘使用預設值
```

## ⚠️ 注意事項

### 權限要求
- 機器人需要讀取群組成員清單的權限
- 部分隱私設定可能影響成員資料獲取

### 成員數量限制
- 最少需要 2 位成員才能分隊
- 建議群組成員 4-20 人之間效果最佳
- 超大群組可能影響處理效率

### 技能值設定
- 群組成員預設技能值：投籃5, 防守5, 體力5
- 註冊球員會覆蓋預設值
- 可在群組內進行個人註冊升級

### 同步機制
- 新成員加入時自動同步
- 成員離開時自動清理
- 可使用 /sync 手動更新

## 🔧 故障排除

### 無法獲取群組成員
1. 檢查 LINE Developers Console 權限設定
2. 確認群組成員隱私設定
3. 嘗試使用 /sync 手動同步
4. 重新加入機器人到群組

### 分隊結果不理想
1. 鼓勵成員個人註冊詳細技能
2. 使用 /group_stats 查看成員分佈
3. 手動調整隊伍數量
4. 使用重新分隊功能

### 成員資料不同步
1. 使用 /sync 手動同步
2. 檢查網路連線狀況
3. 確認機器人服務正常運行

## 📈 進階功能

### Flex Message 互動
- 視覺化成員清單展示
- 一鍵分隊按鈕
- 重新分隊功能
- 技能條圖表顯示

### 統計資訊
- 隊伍平衡度分析
- 技能分佈統計
- 分隊建議算法
- 歷史記錄追蹤

## 🔮 未來規劃

- 群組管理員專用指令
- 自訂技能值範本
- 群組間比賽功能
- 成員評分系統
- 分隊歷史記錄
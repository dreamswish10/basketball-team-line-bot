# Scripts 使用說明

## add_attendance.py - 手動新增組隊記錄

這個工具可以讓您手動新增 attendances 記錄到 MongoDB，支援多種輸入模式並整合了**別名映射系統**，可以使用別名快速識別成員。

### 使用方式

#### 1. 互動模式 (建議新手使用)
```bash
python scripts/add_attendance.py
```
系統會逐步引導您輸入：
- 日期 (預設今天)
- 隊伍成員 (支援快速格式或逐隊輸入)

#### 2. 快速模式 (適合批量操作)
```bash
python scripts/add_attendance.py --date 2025-12-12 --teams "勇,傑,豪|凱,奶,金毛"
```

參數說明：
- `--date`: 指定日期，格式 YYYY-MM-DD
- `--teams`: 隊伍資料，格式說明見下方

#### 3. 範例模式 (快速測試)
```bash
python scripts/add_attendance.py --sample
```
會新增一筆今天的範例記錄，包含兩隊各3人。

### 隊伍資料格式

#### 快速格式
使用 `|` 分隔不同隊伍，使用 `,` 分隔隊員：
```
"勇,傑,豪|凱,🥛,金|Akin,kin,軍"
```

**✨ 別名支援**: 可以使用別名代替真實姓名，例如：
- `🥛` → `奶`  
- `kin` → `Akin`
- `金` → `金毛`

#### 注意事項
- 每隊最多3人，超過會自動截取前3位
- **別名自動識別**: 輸入別名會自動對應到真實 userId
- **未識別處理**: 無法識別的名稱會自動創建為 "路人1", "路人2" 等
- 如果該日期已有記錄，會提示是否覆蓋

### 範例操作

#### 新增今天的記錄（使用別名）
```bash
python scripts/add_attendance.py --teams "勇,豪,傑|凱,🥛,金"
```

#### 新增指定日期記錄
```bash
python scripts/add_attendance.py --date 2025-12-10 --teams "宇,舊,圈|翔,華,小明"
```

#### 混合使用別名和新成員
```bash
python scripts/add_attendance.py --teams "🥛,kin,John|勇,Alice,Bob"
```

#### 使用互動模式
```bash
python scripts/add_attendance.py
# 然後按照提示輸入資訊
```

### 輸出範例
```
🚀 快速新增模式
====================

🔍 別名映射結果:
✅ 已識別: 🥛→奶, kin→Akin, 勇, 金→金毛
❓ 未識別: John→路人1, Alice→路人2

📅 日期: 2025-12-12

📋 隊伍預覽:
  第1隊 (3人): 奶, Akin, 路人1
  第2隊 (3人): 勇, 路人2, 金毛

✅ 記錄新增成功！
✅ 驗證成功: 2 隊，共 6 人
   記錄ID: 675b2c8f1234567890abcdef

🎉 操作完成！
```

### 別名映射功能

- **自動識別**: 輸入的別名會自動對應到系統中的真實用戶
- **實時顯示**: 會顯示哪些名稱已識別、哪些被創建為新用戶
- **完整整合**: 與現有分隊系統的別名資料庫完全同步